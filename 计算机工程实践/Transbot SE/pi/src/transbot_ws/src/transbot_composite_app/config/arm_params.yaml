# 机械臂控制参数配置

# MoveIt!规划参数
moveit:
  # 规划组配置
  planning_groups:
    arm:
      group_name: "arm"
      end_effector: "gripper_link"
      planning_frame: "base_link"
      
  # 规划器参数
  planner:
    planning_time: 10.0        # 规划时间限制 (s)
    planning_attempts: 5       # 规划尝试次数
    max_velocity_scaling: 0.3  # 最大速度缩放
    max_acceleration_scaling: 0.3  # 最大加速度缩放
    
  # 轨迹执行参数
  trajectory:
    execution_timeout: 15.0    # 执行超时时间 (s)
    goal_tolerance: 0.01       # 目标容差 (rad)
    path_tolerance: 0.05       # 路径容差 (rad)
    
  # 碰撞检测
  collision:
    enable_collision_checking: true
    self_collision_check: true
    collision_padding: 0.02    # 碰撞填充 (m)

# 关节限制
joint_limits:
  # 关节1 (底座旋转)
  joint1:
    min_position: -3.14       # 最小位置 (rad)
    max_position: 3.14        # 最大位置 (rad)
    max_velocity: 1.0         # 最大速度 (rad/s)
    max_acceleration: 2.0     # 最大加速度 (rad/s²)
    
  # 关节2 (肩部)
  joint2:
    min_position: -1.57
    max_position: 1.57
    max_velocity: 1.0
    max_acceleration: 2.0
    
  # 关节3 (肘部)
  joint3:
    min_position: -2.35
    max_position: 2.35
    max_velocity: 1.0
    max_acceleration: 2.0
    
  # 关节4 (腕部1)
  joint4:
    min_position: -1.57
    max_position: 1.57
    max_velocity: 1.5
    max_acceleration: 3.0
    
  # 关节5 (腕部2)
  joint5:
    min_position: -1.57
    max_position: 1.57
    max_velocity: 1.5
    max_acceleration: 3.0
    
  # 关节6 (腕部3)
  joint6:
    min_position: -3.14
    max_position: 3.14
    max_velocity: 2.0
    max_acceleration: 4.0

# 预定义姿态
predefined_poses:
  # 基础姿态
  home:
    joints: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    description: "初始归位姿态"
    
  ready:
    joints: [0.0, -0.5, 0.5, 0.0, 0.0, 0.0]
    description: "准备姿态"
    
  pick_approach:
    joints: [0.0, -0.8, 1.2, 0.0, -0.4, 0.0]
    description: "抓取接近姿态"
    
  pick:
    joints: [0.0, -0.9, 1.4, 0.0, -0.5, 0.0]
    description: "抓取姿态"
    
  place_approach:
    joints: [1.57, -0.8, 1.2, 0.0, -0.4, 0.0]
    description: "放置接近姿态"
    
  place:
    joints: [1.57, -0.9, 1.4, 0.0, -0.5, 0.0]
    description: "放置姿态"
    
  # 观察姿态
  observe:
    joints: [0.0, -0.3, 0.8, 0.0, -0.5, 0.0]
    description: "观察姿态"

# 工作空间限制
workspace:
  # 笛卡尔空间限制
  cartesian_limits:
    x_min: -0.5
    x_max: 0.5
    y_min: -0.5
    y_max: 0.5
    z_min: 0.0
    z_max: 0.8
    
  # 朝向限制 (RPY, rad)
  orientation_limits:
    roll_min: -1.57
    roll_max: 1.57
    pitch_min: -1.57
    pitch_max: 1.57
    yaw_min: -3.14
    yaw_max: 3.14

# 控制器参数
controllers:
  # 位置控制器
  position_controller:
    type: "position_controllers/JointTrajectoryController"
    gains:
      joint1: {p: 1000, i: 0, d: 100}
      joint2: {p: 1000, i: 0, d: 100}
      joint3: {p: 1000, i: 0, d: 100}
      joint4: {p: 500, i: 0, d: 50}
      joint5: {p: 500, i: 0, d: 50}
      joint6: {p: 500, i: 0, d: 50}
      
  # 速度控制器
  velocity_controller:
    type: "velocity_controllers/JointGroupVelocityController"
    max_velocity: [1.0, 1.0, 1.0, 1.5, 1.5, 2.0]

# 夹爪参数
gripper:
  # 夹爪控制
  control:
    open_position: 0.08       # 张开位置 (m)
    close_position: 0.0       # 闭合位置 (m)
    max_effort: 50.0          # 最大力 (N)
    
  # 抓取参数
  grasp:
    approach_distance: 0.05   # 接近距离 (m)
    retreat_distance: 0.05    # 后退距离 (m)
    grasp_force: 30.0         # 抓取力 (N)

# 安全参数
safety:
  # 急停参数
  emergency_stop:
    enable: true
    deceleration: 5.0         # 急停减速度 (rad/s²)
    
  # 监控参数
  monitoring:
    joint_temperature_limit: 60.0  # 关节温度限制 (°C)
    motor_current_limit: 10.0       # 电机电流限制 (A)
    
  # 碰撞检测
  collision_detection:
    enable: true
    sensitivity: 0.8          # 敏感度 (0-1)
    
# 演示序列
demo_sequences:
  # 简单演示
  simple_demo:
    - {action: "goto_pose", pose: "ready", duration: 3.0}
    - {action: "goto_pose", pose: "pick_approach", duration: 3.0}
    - {action: "goto_pose", pose: "pick", duration: 2.0}
    - {action: "gripper", command: "close", duration: 1.0}
    - {action: "goto_pose", pose: "pick_approach", duration: 2.0}
    - {action: "goto_pose", pose: "place_approach", duration: 3.0}
    - {action: "goto_pose", pose: "place", duration: 2.0}
    - {action: "gripper", command: "open", duration: 1.0}
    - {action: "goto_pose", pose: "place_approach", duration: 2.0}
    - {action: "goto_pose", pose: "home", duration: 3.0}
    
  # 观察演示
  observe_demo:
    - {action: "goto_pose", pose: "observe", duration: 3.0}
    - {action: "joint_move", joint: "joint1", angle: 1.57, duration: 2.0}
    - {action: "joint_move", joint: "joint1", angle: -1.57, duration: 4.0}
    - {action: "joint_move", joint: "joint1", angle: 0.0, duration: 2.0}
    - {action: "goto_pose", pose: "home", duration: 3.0} 