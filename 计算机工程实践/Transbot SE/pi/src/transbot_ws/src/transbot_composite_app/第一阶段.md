# 第一阶段：基础框架开发（1-2 周）

## 项目概述

**目标**：完成项目雏形，为后续功能迭代奠定"能跑通、能联调"的基础。

## 一、总体里程碑

- **第 1 天**：创建仓库与 CI/CD（GitLab/GitHub Actions）
- **第 2-3 天**：完成 ROS 包骨架、目录结构、依赖声明
- **第 4-5 天**：实现底盘运动最小闭环（/cmd_vel → 机器人移动）
- **第 6-7 天**：搭建 Web 服务原型 + 摄像头视频流
- **第 8-10 天**：打通 Web → ROS 指令链路，完成"前进/停止"演示
- **第 11-14 天**：集成 transbot_linefollow、transbot_se_moveit_config 的最小可运行示例
- **第 14 天**：阶段评审 & 文档归档

## 二、子任务拆解

### A. 项目初始化
- **A-1** 版本控制：创建 main/dev 分支策略
- **A-2** CI：配置 catkin_make 自动编译、单元测试
- **A-3** README：填写编译、运行指令

### B. ROS 框架搭建
- **B-1** main.py → 空节点、日志输出
- **B-2** navigation.py → 订阅 /cmd_vel、发布假数据
- **B-3** linefollow_controller.py → 调用 transbot_linefollow 示例 launch，验证能够识别线路并输出 /cmd_vel

### C. Web 端原型
- **C-1** 选型 Flask + SocketIO
- **C-2** 路由：/（视频）、/admin（控制台）
- **C-3** 视频流：使用 cv2.VideoCapture(0) + MJPEG 推流
- **C-4** WebSocket：消息结构 `{cmd:"forward", value:0.2}`

### D. Web–ROS 通信
- **D-1** web_utils.py：启动 SocketIO client，监听消息 → 发布 /web_cmd
- **D-2** main.py：订阅 /web_cmd，翻译成 /cmd_vel
- **D-3** 循环演示：网页按钮"前进""停止"控制机器人

### E. transbot_linefollow 集成（最小用例）
- **E-1** 运行官方 launch，记录需要的 topic
- **E-2** linefollow_controller.py：订阅 /follow_cmd → 直通 /cmd_vel
- **E-3** 在地面贴黑线验证循迹

### F. transbot_se_moveit_config 集成（最小用例）
- **F-1** 启动 MoveIt! demo.launch，确认可控制 RViz 模型
- **F-2** arm_controller.py：封装 move_group，实现简单"举起-放下"动作
- **F-3** Web 端增加"机械臂示例"按钮调用

## 三、时间线

| 日期    | 任务           | 负责人      | 产出                           |
|---------|----------------|-------------|--------------------------------|
| D1      | 仓库/CI        | DevOps      | .gitignore, CI 脚本            |
| D2-3    | ROS 包骨架     | Robot Dev   | 目录+package.xml               |
| D4      | 底盘闭环       | Embedded    | /cmd_vel 驱动                  |
| D5-6    | Web 原型       | Frontend    | Flask 页面                     |
| D7      | WebSocket→ROS  | Full-stack  | /web_cmd 节点                  |
| D8-9    | linefollow demo| Robot Dev   | 循迹视频                       |
| D10-11  | MoveIt! demo   | Arm Dev     | RViz 轨迹                      |
| D12-13  | 系统串联       | 全体        | "前进+循迹+机械臂"演示         |
| D14     | 评审           | PM          | 阶段报告                       |

## 四、交付物

1. **代码仓库**：可编译通过（CI 绿灯）
2. **README 文档**：更新编译、运行、测试说明
3. **启动脚本**：composite_delivery.launch 能启动底盘、Web、循迹、机械臂最小功能
4. **Demo 视频**：网页按钮控制机器人前进/停止、循迹行走、机械臂举起

## 五、验收标准

- [ ] catkin_make 无错误；CI 持续集成通过
- [ ] Web 页面在局域网可访问；视频延迟 < 800 ms
- [ ] 点击"前进"按钮，机器人前进 30 cm 并停止偏差 < 5 cm
- [ ] 循迹模式下，沿 3 m 黑线行驶偏差 < 10 cm
- [ ] 机械臂举起-放下动作完成，角度误差 < 10°

## 六、风险与缓解

| 风险                 | 缓解措施                                    |
|----------------------|---------------------------------------------|
| 驱动适配延迟         | 提前准备模拟器/Gazebo 方案                  |
| 网络延迟过高         | 备用 MJPEG → WebRTC 方案                    |
| MoveIt! 规划失败     | 简化动作范围，使用预定义姿态表              |

## 七、资源需求

### 人员配置
- 前端：1 人
- 后端：1 人  
- 机器人：2 人
- DevOps：1 人
- PM：1 人

### 设备清单
- 机器人底盘 × 1
- 机械臂 × 1
- 摄像头 × 2
- 开发电脑 × 3

### 预算需求
- API 调用测试额度
- 服务器 1 台（可用树莓派或 Jetson）